# สคริปต์ Macro Automation

สคริปต์นี้ช่วยให้คุณสามารถทำงานอัตโนมัติของการกระทำของเมาส์และคีย์บอร์ดโดยใช้ส่วนติดต่อผู้ใช้แบบกราฟิก (GUI) ที่ใช้งานง่าย ซึ่งสร้างด้วย Tkinter

## คุณสมบัติเด่น

*   **กำหนดลำดับการกระทำ:** เพิ่มการกระทำหลากหลาย เช่น การพิมพ์, การกดปุ่ม, การใช้ปุ่มลัด (ฮอตคีย์), การคลิกเมาส์, และการเลื่อนเมาส์
*   **การจัดการการกระทำ:**
    *   **เพิ่มการกระทำ (Add Actions):** เพิ่มการกระทำใหม่เข้าสู่ลำดับของคุณได้อย่างง่ายดาย
    *   **แก้ไขการกระทำ (Edit Actions):** ปรับเปลี่ยนประเภทหรือค่าของการกระทำที่มีอยู่
    *   **ลบการกระทำ (Remove Actions):** ลบการกระทำออกจากลำดับ
    *   **จัดลำดับการกระทำ (Reorder Actions):** ใช้ปุ่ม "Move Up" (เลื่อนขึ้น) และ "Move Down" (เลื่อนลง) เพื่อเปลี่ยนลำดับของการกระทำ
*   **บันทึกและโหลด (Save & Load):**
    *   บันทึกลำดับมาโครทั้งหมดของคุณ (การกระทำและการตั้งค่า) ไปยังไฟล์ JSON
    *   โหลดมาโครที่บันทึกไว้ก่อนหน้านี้เพื่อนำกลับมาใช้ใหม่ (เข้าถึงได้ผ่านเมนู File)
*   **การจับตำแหน่งคลิกแบบโต้ตอบ (Interactive Click Coordinate Capture):**
    *   สำหรับการกระทำประเภท "Click", มีปุ่ม "Capture Position" (จับตำแหน่ง) ช่วยให้คุณคลิกที่ใดก็ได้บนหน้าจอเพื่อบันทึกพิกัด X,Y โดยอัตโนมัติ
*   **การตั้งค่าที่ยืดหยุ่น (Flexible Settings):**
    *   **Interval (ช่วงเวลา):** เวลา (วินาที) ระหว่างการกระทำแต่ละอย่าง
    *   **Loops (จำนวนรอบ):** จำนวนครั้งที่ลำดับการกระทำทั้งหมดจะทำงานซ้ำ
    *   **Wait Time Between Loops (เวลารอระหว่างรอบ):** การหน่วงเวลา (วินาที) หลังจากลำดับการกระทำหนึ่งรอบเสร็จสิ้นและก่อนที่รอบถัดไปจะเริ่ม
    *   **Pause Duration (ระยะเวลาพัก):** เวลา (นาที) ที่จะพักระหว่างชุดของรอบการทำงาน
    *   **Number of Sets (จำนวนชุด):** จำนวนครั้งที่วงจรการทำงานซ้ำทั้งหมด (รวมการพัก) ควรจะทำงาน
*   **การควบคุมการทำงาน (Execution Control):** เริ่มและหยุดมาโครได้ตลอดเวลา
*   **การแสดงสถานะ (Status Display):** ดูสถานะปัจจุบันและความคืบหน้าของการทำงานมาโคร
*   **การรับรู้ DPI Scaling (Windows):** มีตรรกะเพื่อปรับปรุงความแม่นยำของพิกัดสำหรับการกระทำ "Click" ในการตั้งค่าหลายจอภาพที่มีเปอร์เซ็นต์การปรับขนาดจอภาพที่แตกต่างกัน

## วิธีการใช้งาน

1.  **สิ่งที่ต้องมีก่อน (Prerequisites):** ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Python พร้อมทั้งไลบรารีที่จำเป็น:
    ```bash
    pip install pyautogui pynput
    ```
2.  **เรียกใช้สคริปต์ (Run the Script):**
    ```bash
    python macro_app.py
    ```
3.  GUI จะเปิดขึ้น:
    *   ใช้ปุ่ม "Add Action", "Edit Action", "Remove Action", "Move Up", "Move Down" เพื่อจัดการลำดับมาโครของคุณ
    *   สำหรับการกระทำ "Click", ใช้ปุ่ม "Capture Position" ในหน้าต่าง Add/Edit
    *   กำหนดค่าการตั้งค่า (Interval, Loops, ฯลฯ) ในแผงด้านขวา
    *   ใช้ "File > Save Actions" เพื่อบันทึกงานของคุณ และ "File > Load Actions" เพื่อโหลดงาน
    *   คลิก "Start Macro" เพื่อเริ่มทำงาน คลิก "Stop Macro" เพื่อหยุดการทำงาน

### ประเภทการกระทำ (Action Types)

*   **Type (พิมพ์):** พิมพ์ข้อความที่ระบุ
*   **Press (กดปุ่ม):** กดปุ่มเฉพาะ (เช่น `enter`, `space`, `a`, `ctrl`, `left`) อ้างอิงชื่อปุ่มจากเอกสารของ PyAutoGUI
*   **HotKey (ปุ่มลัด):** กดปุ่มผสม (เช่น `ctrl+s`, `alt+f4`) คั่นปุ่มด้วย `+`
*   **Click (คลิก):** คลิกเมาส์ ใช้ปุ่ม "Capture Position" เพื่อตั้งค่าพิกัด หรือป้อนด้วยตนเองเป็น "X,Y" หากไม่ระบุพิกัด จะคลิกที่ตำแหน่งปัจจุบันของเมาส์
*   **Move (เลื่อนเมาส์):** เลื่อนเคอร์เซอร์เมาส์ไปยังพิกัด "X,Y"

## การสร้างไฟล์ Executable (Building from Source - ทางเลือก)

หากคุณต้องการสร้างไฟล์ที่สามารถรันได้โดยไม่ต้องมี Python (standalone executable):
1.  ติดตั้ง PyInstaller: `pip install pyinstaller`
2.  ไปที่ไดเรกทอรีของสคริปต์ในเทอร์มินัลของคุณ
3.  รัน PyInstaller ด้วยไฟล์ spec ที่ให้มา (`macro_app.spec`) หรือสร้างใหม่:
    ```bash
    pyinstaller --noconsole --onefile macro_app.py
    ```
    (คุณสามารถเพิ่ม `--add-data "icon.ico:."` หรือตัวเลือกอื่นๆ หากจำเป็น) ไฟล์ executable จะอยู่ในโฟลเดอร์ `dist`

## หมายเหตุ (Notes)

*   สคริปต์นี้ใช้ `tkinter` สำหรับ GUI, `pyautogui` สำหรับการทำงานอัตโนมัติ, และ `pynput` สำหรับการจับการคลิกเมาส์แบบโกลบอล
*   สำหรับการกระทำ "Click" และ "Move", พิกัดจะอ้างอิงจากมุมบนซ้ายของหน้าจอหลักของคุณเป็น (0,0)
*   บน Windows สคริปต์พยายามที่จะรับรู้ DPI เพื่อปรับปรุงความแม่นยำของพิกัดบนจอแสดงผลที่มีการปรับขนาด
