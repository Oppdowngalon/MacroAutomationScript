# แอปพลิเคชันแมโครอัตโนมัติ

แอปพลิเคชัน Python นี้ให้อินเทอร์เฟซกราฟิกสำหรับการทำงานอัตโนมัติของเมาส์และคีย์บอร์ดโดยใช้ Tkinter ช่วยให้ผู้ใช้สร้างลำดับการทำงานอัตโนมัติที่ซับซ้อนด้วยการควบคุมเวลาที่แม่นยำ

## คุณสมบัติ

- **ลำดับการทำงาน**: สร้างลำดับการทำงานประกอบด้วย:
  - พิมพ์ข้อความ
  - กดปุ่ม
  - ใช้ฮ็อตคีย์ (การผสมปุ่ม)
  - คลิกเมาส์ที่ตำแหน่งพิกัดเฉพาะ
  - ย้ายเมาส์ไปยังตำแหน่งที่กำหนด
- **การจัดการการทำงาน**:
  - เพิ่ม แก้ไข และลบการทำงาน
  - จัดลำดับใหม่ด้วยการลากและวาง
  - ตั้งค่าความล่าช้าแต่ละการทำงาน
- **บันทึก & โหลด**:
  - บันทึกการตั้งค่าแมโครทั้งหมด (การทำงาน + การตั้งค่า) เป็นไฟล์ JSON
  - โหลดการตั้งค่าที่บันทึกไว้จากไฟล์ JSON
- **การจับพิกัดแบบโต้ตอบ**:
  - คลิกที่ใดก็ได้บนหน้าจอเพื่อบันทึกพิกัด X,Y สำหรับการทำงานของเมาส์
- **การตั้งค่าขั้นสูง**:
  - ช่วงเวลา: เวลา (วินาที) ระหว่างการทำงาน
  - จำนวนรอบ: จำนวนครั้งที่จะทำซ้ำลำดับ
  - เวลารอระหว่างรอบ: ความล่าช้าหลังจากเสร็จสิ้นแต่ละรอบ
  - ระยะเวลาหยุดพัก: การหยุดพักนานระหว่างชุดของรอบ
  - จำนวนชุด: จำนวนรอบการทำงานที่จะดำเนินการ
- **ควบคุมการทำงาน**:
  - เริ่ม/หยุดการทำงานแมโครได้ทุกเมื่อ
  - นับถอยหลังแสดงผลก่อนเริ่มการทำงาน
- **ตรวจสอบสถานะ**:
  - อัปเดตสถานะแบบเรียลไทม์
  - เวลาคาดว่าจะเสร็จสิ้น (ETA)
- **รองรับการปรับขนาด DPI**:
  - ความแม่นยำของพิกัดที่ดีขึ้นสำหรับการตั้งค่าหลายจอภาพด้วยการปรับขนาดการแสดงผลที่ต่างกัน

## การพึ่งพา

แอปพลิเคชันนี้ต้องการแพ็คเกจ Python ต่อไปนี้:
- pyautogui
- pynput

ติดตั้งโดยใช้:
```bash
pip install pyautogui pynput
```

## การติดตั้ง

1. ตรวจสอบให้แน่ใจว่าติดตั้ง Python 3.6+ ไว้แล้ว
2. ติดตั้งการพึ่งพา:
   ```bash
   pip install -r requirements.txt
   ```
3. เรียกใช้แอปพลิเคชัน:
   ```bash
   python macro_app.py
   ```

## การใช้งาน

1. **เพิ่มการทำงาน**:
   - คลิก "Add Action" และเลือกประเภทการทำงาน
   - สำหรับการทำงานคลิก ใช้ "Capture Position" เพื่อบันทึกพิกัด
   - ตั้งค่าความล่าช้าแต่ละการทำงาน
   
2. **จัดการการทำงาน**:
   - ใช้รายการการทำงานเพื่อดู แก้ไข จัดลำดับใหม่ หรือลบการทำงาน
   - ลากการทำงานเพื่อจัดลำดับใหม่ในลำดับ

3. **ตั้งค่าคอนฟิก**:
   - ตั้งค่าช่วงเวลาระหว่างการทำงาน (วินาที)
   - ตั้งค่าจำนวนรอบและเวลารอระหว่างรอบ
   - ตั้งค่าระยะเวลาหยุดพักและจำนวนชุดสำหรับเซสชันการทำงานอัตโนมัติที่ยาวนาน

4. **บันทึก/โหลด**:
   - ใช้ File > Save Actions เพื่อบันทึกการตั้งค่าของคุณ
   - ใช้ File > Load Actions เพื่อโหลดการตั้งค่าที่บันทึกไว้

5. **การทำงาน**:
   - คลิก "Start Macro" เพื่อเริ่ม (จะเริ่มนับถอยหลัง 10 วินาที)
   - คลิก "Stop Macro" เพื่อหยุดการทำงานเมื่อใดก็ได้

### ประเภทการทำงาน

| ประเภท   | คำอธิบาย                                                                 | ตัวอย่างค่า              |
|--------|-----------------------------------------------------------------------------|-----------------------------|
| Type   | พิมพ์ข้อความที่ระบุ                                                    | "Hello World"               |
| Press  | กดปุ่มเฉพาะ                                                      | "enter", "tab", "a", "1"    |
| HotKey | กดการผสมปุ่ม                                               | "ctrl+s", "alt+f4"          |
| Click  | คลิกที่พิกัดที่ระบุ (ใช้ "Capture Position" หรือป้อน "X,Y")     | "100,200"                   |
| Move   | ย้ายเคอร์เซอร์เมาส์ไปยังพิกัดที่ระบุ                                 | "300,400"                   |

## การตั้งค่า JSON

การตั้งค่าแมโครจะถูกบันทึกในรูปแบบ JSON ด้วยโครงสร้างต่อไปนี้:
```json
{
  "actions": [
    {
      "type": "Click",
      "value": "100,200",
      "delay": 0.5
    },
    {
      "type": "Type",
      "value": "Hello World",
      "delay": 0
    }
  ],
  "settings": {
    "interval": 0.1,
    "loops": 5,
    "inter_loop_wait": 1.0,
    "pause_duration": 5.0,
    "num_sets": 3
  }
}
```

## การสร้างจากซอร์สโค้ด (ตัวเลือก)

เพื่อสร้างไฟล์ปฏิบัติการแบบสแตนด์อโลน:

1. ติดตั้ง PyInstaller:
   ```bash
   pip install pyinstaller
   ```
   
2. สร้างไฟล์ปฏิบัติการ:
   ```bash
   pyinstaller --noconsole --onefile macro_app.py
   ```
   
3. ไฟล์ปฏิบัติการจะอยู่ในโฟลเดอร์ `dist`

## โครงสร้างไฟล์

แอปพลิเคชันประกอบด้วย:
- `macro_app.py`: สคริปต์แอปพลิเคชันหลัก
- `requirements.txt`: รายการการพึ่งพา
- `README.md`: เอกสารประกอบ (ไฟล์นี้)

## หมายเหตุทางเทคนิค

- สร้างด้วย Python 3.9+ และ Tkinter สำหรับ GUI
- ใช้ pyautogui สำหรับการทำงานอัตโนมัติและ pynput สำหรับการจับคลิกแบบโกลบอล
- พิกัดอ้างอิงจากมุมซ้ายบนของหน้าจอหลัก (0,0)
- ใช้การรับรู้ DPI สำหรับตำแหน่งที่แม่นยำบนจอแสดงผลที่ปรับขนาด
- ใช้การทำงานแบบมัลติเธรดเพื่อให้ UI ตอบสนองระหว่างการทำงานอัตโนมัติ

## การแก้ไขปัญหา

- **พิกัดไม่แม่นยำในการตั้งค่าหลายจอภาพ**:
  ตรวจสอบให้แน่ใจว่าจอแสดงผลทั้งหมดมีเปอร์เซ็นต์การปรับขนาดเดียวกันหรือปรับการตั้งค่าการรับรู้ DPI
- **แมโครหยุดทำงานโดยไม่คาดคิด**:
  ตรวจสอบว่าไม่มีไดอะล็อกหรือการแจ้งเตือนขัดขวางการทำงานอัตโนมัติ
- **การกดปุ่มไม่ลงทะเบียน**:
  ตรวจสอบว่าแอปพลิเคชันเป้าหมายมีโฟกัสและไม่ถูกบล็อกโดยหน้าต่างอื่น
